<div id="header">
    <div id="title">
      <i nz-icon nzType="user" nzTheme="outline"></i>
      내부정산
    </div>
</div>
<div id="content">
<div id="main-table">
    <div class="table-menu">
            <button nz-button nzType="default" nzShape="circle" (click)="incamAddfareAdd()"><i title="추가" nz-icon nzType="plus"></i></button>
            <button nz-button nzType="default" nzShape="circle" (click)="incamAddfareUpdate()" [disabled]="selectedIncamAddfare.addfare_seq == undefined"><i nz-icon nzType="edit"></i></button>
            <button nz-button nzType="default" nzShape="circle" (click)="incamAddfareDelete()" [disabled]="selectedIncamAddfare.addfare_seq == undefined"><i nz-icon nzType="delete"></i></button>
          </div>
    <nz-table
      #incamAddfareTable
      nzShowSizeChanger
      nzNoResult = "조회된 결과가 없습니다"
      [nzFrontPagination]="false"
      [nzData]="incamAddfares.data"
      [nzLoading]="incamAddfareLoading"
      [nzTotal]="incamAddfares.totalPages * incamAddfares.size"
      [(nzPageIndex)]="incamAddfares.pageNumber"
      [(nzPageSize)]="incamAddfares.size"
      (nzPageIndexChange)="getIncamAddfares()"
      nzShowSizeChanger="false"
      nzSize="small">
      <thead>
        <tr>
          <th nzWidth="8%">번호</th>
          <th nzWidth="9%">정산일자</th>
          <th nzWidth="9%">원청사</th>
          <th nzWidth="9%">분반</th>
          <th nzWidth="9%">구분</th>
          <th nzWidth="9%">이름</th>
          <th nzWidth="9%">단가</th>
          <th nzWidth="9%">시수</th>
          <th nzWidth="9%">원천세</th>
          <th nzWidth="9%">소득타입</th>
          <th nzWidth="9%">송금</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of incamAddfareTable.data"
          (click)="selectIncamAddfare(data)"
          (dblclick)="incamAddfareUpdate()"
  
          [ngClass]="{
            'on':this.selectedIncamAddfare.addfare_seq === data.addfare_seq
          }"
          style="cursor: pointer;">
          <td>{{ data.addfare_seq }}</td>
          <td>{{ data.addfare_date | date:'yyyy/MM/dd' }}</td>
          <td>{{ data.original_company }}</td>
          <td>{{ data.class }}</td>
          <td>{{ gubun[data.gubun-1].gubun_val }}</td>
          <td>{{ data.name }}</td>
          <td>{{ data.price | number }}</td>
          <td>{{ data.hour }}</td>
          <td>{{ data.tax }}</td>
          <td>{{ income_type[data.income_type-1].income_type_val }}</td>
          <td>{{ data.remit }}</td>
        </tr>
      </tbody>
    </nz-table>
    </div>
</div>
  
  <nz-modal [(nzVisible)]="isIncamAddfareAdd"
            nzTitle="내부정산 추가" 
            (nzOnCancel)="popupCancel()"
            (nzOnOk)="incamAddfareAddOk()"
            nzWidth="550">
    <div class="popup-content">
          <div>
              <nz-date-picker [nzPlaceHolder]="'정산일자'" [(ngModel)]="popupIncamAddfare.addfare_date" [nzShowToday]=false [nzStyle]="{'width': '300px'}" style="margin-bottom: 5px;"></nz-date-picker>          
            </div>
          <div>
              <input nz-input type="text" placeholder="원청사" [(ngModel)]="popupIncamAddfare.original_company"/>
          </div>
          <div>
              <input nz-input type="text" placeholder="분반" [(ngModel)]="popupIncamAddfare.class"/>
          </div>
          <div>
              <nz-select [nzPlaceHolder]="'구분'" [(ngModel)]="popupIncamAddfare.gubun">  
                <nz-option nzValue="1" nzLabel="강사"></nz-option>
                <nz-option nzValue="2" nzLabel="멘토"></nz-option>
              </nz-select>
          </div>
          <div>
              <input nz-input type="text" placeholder="이름" [(ngModel)]="popupIncamAddfare.name"/>
          </div>
          <div>
              <nz-input-number [nzPlaceHolder]="'단가'" [nzStep]="1" [nzMin]="0" [(ngModel)]="popupIncamAddfare.price" ></nz-input-number>
          </div>
          <div>
              <nz-input-number [nzPlaceHolder]="'시수'" [nzStep]="1" [nzMin]="0" [(ngModel)]="popupIncamAddfare.hour"></nz-input-number>
          </div>
          <div>
              <nz-input-number [nzPlaceHolder]="'원천세'" [nzStep]="0.01" [nzMin]="0.01" [nzMax]="1"[(ngModel)]="popupIncamAddfare.tax"></nz-input-number>
          </div>
          <div>
              <nz-select [nzPlaceHolder]="'소득타입'"  [(ngModel)]="popupIncamAddfare.income_type">  
                <nz-option nzValue="1" nzLabel="사업소득"></nz-option>
                <nz-option nzValue="2" nzLabel="기타소득"></nz-option>
              </nz-select>
          </div>
          <div>
              <nz-input-number [nzPlaceHolder]="'송금'" [nzStep]="1" value="0" [(ngModel)]="popupIncamAddfare.remit" style="display: none"></nz-input-number>
          </div>
    </div>
    <div *nzModalFooter>
        <button nz-button nzType="default" (click)="popupCancel()">취소</button>
        <button nz-button nzType="primary" (click)="incamAddfareAddOk()">등록</button>
      </div>
  </nz-modal>

  <nz-modal [(nzVisible)]="isIncamAddfareUpdate"
          nzTitle="내부정산수정" 
          (nzOnCancel)="popupCancel()"
          (nzOnOk)="incamAddfareUpdateOk()"
          nzWidth="350">
  <div class="popup-content">
    <div>
      <nz-input-number [nzPlaceHolder]="'번호'" [nzStep]="1" [nzDisabled]=true [(ngModel)]="popupIncamAddfare.addfare_seq"></nz-input-number>
    </div>
    <div>
      <nz-date-picker [nzPlaceHolder]="'정산일자'" [(ngModel)]="popupIncamAddfare.addfare_date" [nzShowToday]=false [nzStyle]="{'width': '300px'}" style="margin-bottom: 5px;"></nz-date-picker>          
    </div>
  <div>
      <input nz-input type="text" placeholder="원청사" [(ngModel)]="popupIncamAddfare.original_company"/>
  </div>
  <div>
      <input nz-input type="text" placeholder="분반" [(ngModel)]="popupIncamAddfare.class"/>
  </div>
  <div>
      <nz-select [nzPlaceHolder]="'구분'" [(ngModel)]="popupGubun">  
        <nz-option nzValue="1" nzLabel="강사"></nz-option>
        <nz-option nzValue="2" nzLabel="멘토"></nz-option>
      </nz-select>
  </div>
  <div>
      <input nz-input type="text" placeholder="이름" [(ngModel)]="popupIncamAddfare.name"/>
  </div>
  <div>
      <nz-input-number [nzPlaceHolder]="'단가'" [nzStep]="1" [nzMin]="0" [(ngModel)]="popupIncamAddfare.price"  [nzFormatter]="currencyFormatter" [nzParser]="currencyParser"></nz-input-number>
  </div>
  <div>
      <nz-input-number [nzPlaceHolder]="'시수'" [nzStep]="1" [nzMin]="0" [(ngModel)]="popupIncamAddfare.hour"></nz-input-number>
  </div>
  <div>
      <nz-input-number [nzPlaceHolder]="'원천세'" [nzStep]="0.01" [nzMin]="0.01" [nzMax]="1"[(ngModel)]="popupIncamAddfare.tax"></nz-input-number>
  </div>
  <div>
      <nz-select [nzPlaceHolder]="'소득타입'"  [(ngModel)]="popupIncomeType">  
        <nz-option nzValue="1" nzLabel="사업소득"></nz-option>
        <nz-option nzValue="2" nzLabel="기타소득"></nz-option>
      </nz-select>
  </div>
  <div>
      <nz-input-number [nzPlaceHolder]="'송금'" [nzStep]="1" value="0" [(ngModel)]="popupIncamAddfare.remit" style="display: none"></nz-input-number>
  </div>
  </div>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="popupCancel()">취소</button>
    <button nz-button nzType="primary" (click)="incamAddfareUpdateOk()">등록</button>
  </div>
</nz-modal>
